<!DOCTYPE html>
<html lang="ja">
<head>
  <link rel="apple-touch-icon" href="icon-192.png">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta charset="UTF-8">
  <title>Áä¨Á®ÆÂΩì„Å¶„ÇØ„Ç§„Ç∫</title>
  <link rel="manifest" href="manifest.json">
  <meta name="theme-color" content="#f0f0f0">
  <style>
    @import url('https://fonts.googleapis.com/css2?family=Kosugi+Maru&display=swap');

    body {
      font-family: 'Kosugi Maru', sans-serif;
      padding: 20px;
      text-align: center;
      background-color: #e0f7fa;
      color: #333;
    }

    #logo {
      width: 80px;
      height: auto;
      margin-bottom: 10px;
    }

    img {
      width: 100%;
      max-width: 300px;
      height: auto;
      object-fit: cover;
      border-radius: 12px;
      margin: 0 auto;
      display: block;
    }

    .choices {
      margin-top: 20px;
      display: flex;
      flex-direction: column;
      gap: 10px;
      align-items: center;
    }

    button {
      padding: 12px 20px;
      font-size: 1.2rem;
      width: 80%;
      max-width: 300px;
      border-radius: 12px;
      border: 2px solid #ccc;
      background-color: #fff;
      color: #444;
      cursor: pointer;
      font-family: 'Kosugi Maru', sans-serif;
      transition: background-color 0.2s;
    }

    button:hover {
      background-color: #f0f0f0;
    }

    #result {
      margin-top: 20px;
      font-weight: bold;
      font-size: 1.2rem;
    }

    #score {
      margin-top: 10px;
      font-size: 1rem;
      color: #333;
    }

    #resetBtn {
      margin-top: 20px;
      background-color: #ffcaca;
    }

    #characterSpeech {
      margin-top: 10px;
      display: none;
      align-items: center;
      justify-content: center;
      gap: 10px;
      font-size: 1.1rem;
    }

    #characterSpeech img {
      width: 60px;
      height: auto;
    }
  </style>
</head>
<body>
  <img src="fuku.png" id="logo" alt="„Ç≠„É£„É©„É≠„Ç¥">
  <h1>„Åì„ÅÆÁä¨Á®Æ„Å™„Éº„Çì„Å†Ôºü</h1>
  <img id="dogImage" src="" alt="Áä¨„ÅÆÁîªÂÉè">
  <div class="choices" id="choices"></div>
  <div id="result"></div>
  <div id="characterSpeech">
    <img src="fuku.png" alt="„Ç≠„É£„É©">
    <span id="speechText"></span>
  </div>
  <div id="score">Ê≠£Ëß£: 0 / ‰∏çÊ≠£Ëß£: 0</div>
  <button id="nextBtn" style="display:none;">Ê¨°„ÅÆÂïèÈ°å</button>
  <button id="resetBtn">„Çπ„Ç≥„Ç¢„Çí„É™„Çª„ÉÉ„Éà</button>

  <script>
    let correctBreed = "";
    let correctCount = 0;
    let wrongCount = 0;

    const breedMap = {
      "shiba": "Êü¥Áä¨", "akita": "ÁßãÁî∞Áä¨", "pug": "„Éë„Ç∞", "beagle": "„Éì„Éº„Ç∞„É´", "poodle": "„Éó„Éº„Éâ„É´", "mix": "„Éü„ÉÉ„ÇØ„ÇπÁä¨" // ‚Üê Áü≠Á∏ÆÔºàÊú¨Êù•„ÅØÂÖ®Á®ÆÔºâ
    };

    const dogImage = document.getElementById("dogImage");
    const choicesDiv = document.getElementById("choices");
    const resultDiv = document.getElementById("result");
    const scoreDiv = document.getElementById("score");
    const nextBtn = document.getElementById("nextBtn");
    const resetBtn = document.getElementById("resetBtn");
    const characterSpeech = document.getElementById("characterSpeech");
    const speechText = document.getElementById("speechText");

    function updateScore() {
      scoreDiv.textContent = `Ê≠£Ëß£: ${correctCount} / ‰∏çÊ≠£Ëß£: ${wrongCount}`;
    }

    async function fetchDog() {
      resultDiv.textContent = "";
      nextBtn.style.display = "none";
      choicesDiv.innerHTML = "";
      characterSpeech.style.display = "none";

      const res = await fetch("https://dog.ceo/api/breeds/image/random");
      const data = await res.json();
      const url = data.message;
      dogImage.src = url;

      correctBreed = extractBreed(url);
      generateChoices(correctBreed);
    }

    function extractBreed(url) {
      const parts = url.split("/");
      const breedSegment = parts[4];
      const subparts = breedSegment.split("-");
      let candidates = [];
      for (let i = 0; i < subparts.length; i++) {
        for (let j = i + 1; j <= subparts.length; j++) {
          candidates.push(subparts.slice(i, j).join("").toLowerCase());
        }
      }
      for (const key of candidates) {
        if (breedMap[key]) return key;
      }
      return "mix";
    }

    function generateChoices(correct) {
      const allBreeds = Object.keys(breedMap);
      const choices = [correct];
      while (choices.length < 4) {
        const rand = allBreeds[Math.floor(Math.random() * allBreeds.length)];
        if (!choices.includes(rand)) choices.push(rand);
      }
      choices.sort(() => Math.random() - 0.5);

      choices.forEach(breed => {
        const btn = document.createElement("button");
        btn.textContent = breedMap[breed];
        btn.onclick = () => {
          if (breed === correct) {
            resultDiv.textContent = "Ê≠£Ëß£ÔºÅüéâ";
            speechText.textContent = "„ÇÑ„Å£„Åü„Å≠ÔºÅÊ≠£Ëß£„Å†„Çà„ÄúÔºÅ";
            correctCount++;
          } else {
            resultDiv.textContent = `‰∏çÊ≠£Ëß£‚Ä¶Ê≠£Ëß£„ÅØ„Äå${breedMap[correct]}„Äç„Å†„Çà`;
            speechText.textContent = "„Å©„Çì„Åæ„ÅÑÔºÅÊ¨°„Åå„ÅÇ„Çã„ÇàÔºÅ";
            wrongCount++;
          }
          updateScore();
          characterSpeech.style.display = "flex";
          nextBtn.style.display = "inline-block";
        };
        choicesDiv.appendChild(btn);
      });
    }

    nextBtn.onclick = fetchDog;
    resetBtn.onclick = () => {
      correctCount = 0;
      wrongCount = 0;
      updateScore();
      resultDiv.textContent = "„Çπ„Ç≥„Ç¢„Çí„É™„Çª„ÉÉ„Éà„Åó„Åü„Çà";
      characterSpeech.style.display = "none";
    };

    fetchDog();
  </script>
</body>
</html>
